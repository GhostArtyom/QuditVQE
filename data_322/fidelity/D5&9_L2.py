import os
from scipy.io import savemat

# 2024-01-19 D9_L2, Eval: 500, loss_tol: 1e-12, gtol: 1e-12
fidelity = {
    'num1': [
        0.9617554833246672, 0.9704350710275164, 0.9892862158667609, 0.9994392735740232, 0.9998335210796601,
        0.9999791735702322, 0.9999788854135511, 0.999989156906408, 0.9999989165174641, 0.9999957803995483,
        0.9999971372589765, 0.999996203411881, 0.9999985297680456, 0.9999984629070369, 0.9999988485035154,
        0.9999974062835336, 0.9999969194961101, 0.9999986975735274, 0.9999988170750815, 0.9999989719844034,
        0.9999990104454513, 0.9999997399393973, 0.9999995960243385, 0.9999997451710452, 0.9999994909393108,
        0.9999996450021515, 0.9999989873463905, 0.9999996344985846, 0.9999988209181478, 0.9999994453651209,
        0.9999984279882854, 0.9999996496724832, 0.9999958650163461, 0.99999991002494, 0.9999997620559244,
        0.99999981375596, 0.9999996697206308, 0.9999998698779831, 0.9999998632544055, 0.9999997800655305
    ],
    'num2': [
        0.9979403341674667, 0.9987410136200778, 0.9981149476240618, 0.9999645534801196, 0.9999893465239353,
        0.9999939646096054, 0.9999981041119880, 0.9999962981831538, 0.9999985117846281, 0.9999997846801302,
        0.9999997334590828, 0.9999992245043285, 0.9999997166872224, 0.9999995692865434, 0.9999984357145331,
        0.9999986541406416, 0.9999991393414848, 0.9999998425964917, 0.9999983169525943, 0.9999992584916136,
        0.999999311847755, 0.9999996932237183, 0.9999983808207822, 0.9999997597283896, 0.9999998892334339,
        0.9999989094116848, 0.9999994879094852, 0.9999991909399493, 0.9999997739079123, 0.9999999721413593,
        0.9999995861361362, 0.9999999144124769, 0.9999988569907845, 0.9999999026579214, 0.9999989856939172,
        0.9999997555992127, 0.9999995997728244, 0.9999985512281144, 0.99999991880818, 0.9999995185162867
    ],
    'num3': [
        0.933571314471861, 0.9854154582724525, 0.9902265987806878, 0.984422147597338, 0.9990012435708682,
        0.9999039782123605, 0.9999870885996305, 0.9999951446238738, 0.9999895277338212, 0.9999917063648567,
        0.999993638932889, 0.9999974593218525, 0.9999958457901077, 0.9999963908361263, 0.9999981463839414,
        0.9999980480973364, 0.9999986174576252, 0.9999990375845698, 0.9999990121443356, 0.9999989543945097,
        0.9999992071831976, 0.9999979846298215, 0.9999992751079414, 0.9999995477585752, 0.9999991199759194,
        0.9999988757470661, 0.9999997225784405, 0.9999989846950128, 0.999999311349249, 0.9999994580284763,
        0.9999976317526629, 0.9999964224415535, 0.9999994866221147, 0.9999993594134208, 0.9999995336912183,
        0.9999998561078772, 0.9999984693648589, 0.9999998362845882, 0.9999991547225997, 0.9999998956622053
    ],
    'num4': [
        0.8790454029015492, 0.9496673098930248, 0.9859338725834761, 0.9552253609073851, 0.9976386706712298,
        0.9998393021778118, 0.9999687343872679, 0.9999767734284357, 0.9999724404381551, 0.9999901947499402,
        0.9999957401767663, 0.9999908765462867, 0.999991909335785, 0.9999929601087953, 0.9999963553419347,
        0.9999957617994242, 0.9999968634949697, 0.9999991375054063, 0.999997960599073, 0.9999981551994132,
        0.9999986632110596, 0.9999987913169669, 0.9999996934575774, 0.999998862789216, 0.9999991904694544,
        0.9999991489523112, 0.9999999694075506, 0.9999997976463826, 0.9999995453919661, 0.9999994314924819,
        0.999999318684167, 0.9999992417559023, 0.9999989864295674, 0.9999995672318642, 0.9999994475928664,
        0.9999990893645132, 0.9999999640914572, 0.9999995513968798, 0.9999992477510264, 0.9999997575208573
    ],
    'num5': [
        0.9650684920430554, 0.9671393895510254, 0.9959301350667873, 0.9998719060007113, 0.9999458000372964,
        0.999965238977313, 0.9999795956021398, 0.9999926094762437, 0.999994031398969, 0.9999966228979644,
        0.9999968455767154, 0.9999983372056015, 0.999998880500888, 0.9999963787307606, 0.9999993288455189,
        0.9999983647546893, 0.9999992114488288, 0.9999994057269541, 0.9999996611531172, 0.9999996075460148,
        0.9999997577078218, 0.9999998580810578, 0.9999995410066578, 0.999999895580831, 0.9999993659513993,
        0.9999985637395506, 0.9999990954164661, 0.9999997136598899, 0.9999999368942403, 0.9999999637079614,
        0.999999193264875, 0.9999995651364215, 0.9999995769249668, 0.9999997644859813, 0.999995697741791,
        0.9999999454451312, 0.9999994810345582, 0.9999999404875566, 0.9999971438421005, 0.9999994700193074
    ]
}
for num in range(1, 6):
    sub = [i for i in sorted(os.listdir('./data_322')) if f'num{num}' in i][0]
    path = f'./data_322/{sub}'  # path of subfolder
    # print(num, fidelity[f'num{num}'])
    # savemat(f'{path}/fidelity_num{num}_D9_L2.mat', {'fidelity': fidelity[f'num{num}']})

# 2024-01-23 D5_L2, Eval: 500, loss_tol: 1e-12, gtol: 1e-12
fidelity = {
    'num1': [
        0.9993232272250057, 0.9914233490137979, 0.9965275014354146, 0.9996325521405218, 0.9998639807958072,
        0.9999992977900146, 0.9999856779830664, 0.9999991904503778, 0.9999958836065987, 0.999995640882225,
        0.9999987004445674, 0.9999982417782245, 0.9999983957084034, 0.999998486753758, 0.9999981250556182,
        0.9999990499578681, 0.9999969995743045, 0.9999986244254488, 0.9999954726445964, 0.999999825233874,
        0.9999997980223443, 0.9999997736437963, 0.9999980759818685, 0.9999996005218132, 0.9999995322587378,
        0.9999985266754758, 0.999998906884545, 0.9999998139887376, 0.9999989829769778, 0.9999983390995074,
        0.9999998378080778, 0.9999998525582914, 0.9999998492670878, 0.9999999278672919, 0.9999984872807368,
        0.9999997778063506, 0.9999993771382574, 0.999999808592916, 0.9999979754337459, 0.9999997414899132
    ],
    'num2': [
        0.9979662582983877, 0.9986813141225841, 0.9986110217279236, 0.9999806470578718, 0.9999993228547944,
        0.9999992415778446, 0.9999921929216568, 0.999998603426064, 0.9999995133830337, 0.9999957179183333,
        0.9999995404837912, 0.9999994744958542, 0.999997973836509, 0.9999992916360538, 0.9999999551282245,
        0.9999989710623822, 0.999999294243354, 0.9999999065056036, 0.9999981730856145, 0.9999996992857818,
        0.9999994143178819, 0.9999994348665251, 0.9999997618542881, 0.9999994126157228, 0.9999998299172084,
        0.9999979156803651, 0.9999994491719608, 0.9999993727741054, 0.9999992732759453, 0.9999991676297215,
        0.9999975699933445, 0.9999997191176849, 0.9999998518987606, 0.9999995304567821, 0.9999998581641676,
        0.9999991900070252, 0.9999996223723426, 0.9999985356053407, 0.9999993164926276, 0.9999990595303969
    ],
    'num3': [
        0.997884142960926, 0.9962932798309575, 0.9978683463354528, 0.998692421144387, 0.9998828209948645,
        0.9999997119376925, 0.9999934012525176, 0.9999992354298608, 0.9999869715282645, 0.9999960739471114,
        0.9999932346812268, 0.9999981844436938, 0.9999963044368534, 0.9999975837759773, 0.9999980351882184,
        0.9999982587787936, 0.9999986818891444, 0.9999995732835749, 0.9999990904208054, 0.9999998615322909,
        0.9999991624649848, 0.9999979772398605, 0.9999995562481583, 0.9999993585034808, 0.9999998699562168,
        0.9999982941912672, 0.9999990704496844, 0.9999994424663888, 0.9999995843422083, 0.9999994647366552,
        0.9999993941905159, 0.9999997446789913, 0.999999545573097, 0.9999986688365781, 0.9999998282743686,
        0.9999996714168332, 0.999996555505988, 0.9999998188667629, 0.9999975764125631, 0.9999996769884644
    ],
    'num4': [
        0.9953136669436368, 0.9859819639706634, 0.9978742825680968, 0.9986863683900956, 0.9999112029727695,
        0.9996019005545698, 0.9999693099343747, 0.9999512585440459, 0.9999900935458298, 0.9999967168505779,
        0.9999827281290624, 0.9999907526197065, 0.9999958567866161, 0.9999979704657429, 0.9999986934533525,
        0.9999981862902961, 0.9999968625340763, 0.999999368838002, 0.9999993427865178, 0.9999995474394994,
        0.9999987546625542, 0.999998784455929, 0.9999982998950186, 0.9999987494324905, 0.9999990983425439,
        0.9999989157915083, 0.9999989522964973, 0.9999991283048941, 0.9999983336809564, 0.9999993219169212,
        0.999999145936841, 0.9999996783062486, 0.9999999088945571, 0.9999987761661127, 0.9999993427066931,
        0.999999744449307, 0.9999998681771816, 0.9999994744734702, 0.9999993896152823, 0.9999996840631682
    ],
    'num5': [
        0.998094987102364, 0.997150498211435, 0.9997021296009085, 0.9999350393023094, 0.9999789826179868,
        0.9999927450457824, 0.9999935207991452, 0.9999926585435045, 0.9999983887131371, 0.9999968929237789,
        0.999999047764252, 0.9999991540823437, 0.9999966693492639, 0.9999995863283111, 0.9999985419235853,
        0.999999742523371, 0.9999995009210385, 0.9999971453926064, 0.9999997670609501, 0.999999533637724,
        0.9999997548181669, 0.9999999469847443, 0.9999999447302454, 0.9999994380233928, 0.9999985536382625,
        0.9999989074045436, 0.9999987541429545, 0.9999999205354158, 0.9999997952981681, 0.9999999427363444,
        0.9999997954732425, 0.9999999650250315, 0.9999999628916534, 0.9999999440169342, 0.9999996773429773,
        0.9999988773835712, 0.9999996706767157, 0.9999996051057174, 0.9999989816055794, 0.9999998420662505
    ]
}
for num in range(1, 6):
    sub = [i for i in sorted(os.listdir('./data_322')) if f'num{num}' in i][0]
    path = f'./data_322/{sub}'  # path of subfolder
    # print(num, fidelity[f'num{num}'])
    # savemat(f'{path}/fidelity_num{num}_D5_L2.mat', {'fidelity': fidelity[f'num{num}']})