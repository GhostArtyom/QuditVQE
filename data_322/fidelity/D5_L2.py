import os
from scipy.io import savemat
from collections import defaultdict

fidelity = {
    'num1': defaultdict(list),
    'num2': defaultdict(list),
    'num3': defaultdict(list),
    'num4': defaultdict(list),
    'num5': defaultdict(list)
}
fidelity_20240202 = {
    'num1': {
        'vec1': [0.9992741631646074, 0.9993014172110269, 0.998161296040952, 0.9985596117375612, 0.9989809524215505],
        'vec2': [0.9955431697094849, 0.9933422549896271, 0.9922618874777588, 0.9978385677937205, 0.9978066246074941],
        'vec3': [0.9962739068574461, 0.9934214141815548, 0.9863611881600586, 0.9952364837894816, 0.9976951773678556],
        'vec4': [0.9967210935926402, 0.9974019065234625, 0.9933463145445809, 0.9997845104232518, 0.9995254194313064],
        'vec5': [0.9999389065854386, 0.9999194052516596, 0.9998271285730995, 0.9999564644782658, 0.9998395286128368],
        'vec6': [0.9999980693661048, 0.9999861467124065, 0.9999454267673384, 0.7485623326464376, 0.9999713320257472],
        'vec7': [0.9999788493783148, 0.9999841801892319, 0.9999945125537009, 0.9999956106827341, 0.9999887306945812],
        'vec8': [0.9999897836454416, 0.9999985183332956, 0.9999964785688644, 0.9999955498336519, 0.9999960029811199],
        'vec9': [0.9999947000993106, 0.999993127201689, 0.9999960281117449, 0.9999934357491785, 0.9999978087357961],
        'vec10': [0.9999986041039991, 0.9999953648545946, 0.9999988784335423, 0.9999952732680905, 0.9999980839127031],
        'vec11': [0.9999976054297471, 0.9999965959108743, 0.9999963187696214, 0.9999969920334235, 0.9999979993190025],
        'vec12': [0.9999971183859193, 0.999998675833117, 0.999999013041192, 0.9999992459384406, 0.9999980627716535],
        'vec13': [0.9999988439559828, 0.9999999779119939, 0.9999991219032621, 0.9999989978089711, 0.99999866553415],
        'vec14': [0.9999994933814158, 0.9999989182378495, 0.9999995833780693, 0.9999978720293248, 0.9999978610429746],
        'vec15': [0.9999994132308294, 0.9999999999931026, 0.999999239947559, 0.9999990694082331, 0.9999992483130227],
        'vec16': [0.9999993177504714, 0.9999991202640728, 0.9999993107329408, 0.9999781709546003, 0.9999992324443621],
        'vec17': [0.9999977311584773, 0.9999989942090284, 0.9999997160802802, 0.9999999891229281, 0.9999990792057696],
        'vec18': [0.9999986703901871, 0.9999989476374787, 0.9999990607137317, 0.9999994226141622, 0.9993269251128936],
        'vec19': [0.9999996872460526, 0.9999996840252059, 0.9999991326610588, 0.999997954361595, 0.9999993454904116],
        'vec20': [0.999999542874904, 0.9999993830987792, 0.9999998960942609, 0.999999564667966, 0.9999994996175502],
        'vec21': [0.9999990420379729, 0.9999991172338321, 0.9999989519135648, 0.9999998158743658, 0.9999998315780518],
        'vec22': [0.9999996313511446, 0.9999997008401327, 0.999999561573687, 0.9999997576584663, 0.9999993152450862],
        'vec23': [0.9999996217588903, 0.9999996589154173, 0.9999980239164413, 0.9999999264381358, 0.999999506668256],
        'vec24': [0.999999818200055, 0.9999995186487318, 0.9999990414768358, 0.9999986134701588, 0.9999992613283577],
        'vec25': [0.9999998382641356, 0.9999998217862587, 0.9999908222732505, 0.9999998603762962, 0.9999999032926347],
        'vec26': [0.9999997756182493, 0.9999997924175461, 0.9999999055165855, 0.9999995470520541, 0.9999993295771834],
        'vec27': [0.9999991839983557, 0.9999991990274212, 0.9999997589027554, 0.9999989940160493, 0.9999974971224498],
        'vec28': [0.9999969926738566, 0.9999981388055941, 0.9999998771672138, 0.9999995893727299, 0.9999993272357914],
        'vec29': [0.999999243241602, 0.9999993662322735, 0.999999537350746, 0.9999954734999841, 0.9999993957653668],
        'vec30': [0.9999995764641714, 0.9999895656293576, 0.9999997487422791, 0.9999997849812169, 0.9999995433917857],
        'vec31': [0.9999993173925676, 0.9999996245879866, 0.9999999447613357, 0.9999998269131547, 0.9999998847901336],
        'vec32': [0.9999999609620775, 0.9999996685993876, 0.9999985389370659]
    },
    'num2': {
        'vec1': [0.9991780504267896, 0.9988057371945398, 0.9993534069325805, 0.9992105887015786, 0.9995213028399036],
        'vec2': [0.9985015065603607, 0.9992163211457842, 0.995267772477253, 0.9909463489028962, 0.9993726667685476],
        'vec3': [0.9996457215432222, 0.9982002472548149, 0.9997826286691309, 0.9982109189672184, 0.9998061936420385],
        'vec4': [0.9999558044487551, 0.9999866878789693, 0.9999568732650795, 0.999948216686547, 0.9999992413559168],
        'vec5': [0.9999965702559126, 0.999999991437467, 0.9999948804945118, 0.999992701783278, 0.9999912001146296],
        'vec6': [0.9999981278369828, 0.9999999778031871, 0.999996434909606, 0.9999970536532272, 0.9999967046948245],
        'vec7': [0.9999976128495548, 0.9999986279778978, 0.9999960816131577, 0.999999445999441, 0.999999743588722],
        'vec8': [0.9999986543260473, 0.999999132421789, 0.9999995280269534, 0.999996876268921, 0.9999987321468303],
        'vec9': [0.9999986360934171, 0.9999959201736135, 0.9999989966462699, 0.999999581680635, 0.999999389101587],
        'vec10': [0.9999995001055353, 0.9999973239668498, 0.9999988124339376, 0.9999991974656509, 0.9999988487890619],
        'vec11': [0.999999887489827, 0.999999951882557, 0.999999775500124, 0.9999997888990364, 0.9999997228080126],
        'vec12': [0.9999988083191628, 0.9999997721927111, 0.9999994342131651, 0.9999993729167675, 0.9999986641187122],
        'vec13': [0.9999999798765296, 0.9999988471117334, 0.9999990734708673, 0.9999998709450793, 0.9999996258213265],
        'vec14': [0.9999997315233614, 0.9999991799988283, 0.9999993639928628, 0.9999991745638523, 0.9999991597463902],
        'vec15': [0.9999994923484338, 0.9999996478050512, 0.49999991273884914, 0.9999997138061071, 0.9999994160206978],
        'vec16': [0.9999997869341107, 0.9999991413520626, 0.9999977732808589, 0.9999995319481803, 0.9999997697097622],
        'vec17': [0.9999994489819467, 0.9999998208009881, 0.9999984402484839, 0.9999988501425362, 0.9999990422365711],
        'vec18': [0.9999999365041188, 0.9999982363541845, 0.999998854022397, 0.9999988389617023, 0.9999992046516915],
        'vec19': [0.9999996301754115, 0.9999997652166579, 0.9999997956059579, 0.9999983674768665, 0.9999997604988593],
        'vec20': [0.9999987532655945, 0.9999999175449479, 0.9999998582830818, 0.9999993242244141, 0.9999987553124803],
        'vec21': [0.9999997829425671, 0.9999998075557408, 0.9999989494416835, 0.9999997016100044, 0.9999998360480653],
        'vec22': [0.9999995368936901, 0.9999915446931088, 0.9999997419359825, 0.9999992687670689, 0.9999997941904546],
        'vec23': [0.9999999201413471, 0.9999989331368105, 0.9999979952233363, 0.999999997811106, 0.999999809321272],
        'vec24': [0.999999886199274, 0.9999994882762807, 0.9999998432809066, 0.9999983006102202, 0.9999994527536447],
        'vec25': [0.9999996771911372, 0.9999994286725589, 0.9999997452194811, 0.999999334808388, 0.9999997179616247],
        'vec26': [0.9999986450093438, 0.9999990337116839, 0.9999972191836761, 0.9999999066592229, 0.9999993631034652],
        'vec27': [0.999999593515304, 0.9999998999573868, 0.9999999521160619, 0.9999998066580744, 0.9999992734352035],
        'vec28': [0.9999999329056268, 0.9999999624727445, 0.9999998814757266, 0.999999301849122, 0.999998998006355],
        'vec29': [0.9999976627053712, 0.9999999503537518, 0.9999976290100568, 0.9999967550432045, 0.9999998063022901],
        'vec30': [0.9999957630596638, 0.9999998951055378, 0.9999994733355242, 0.49999886999811083, 0.9999999961979616],
        'vec31': [0.9999985498486189, 0.9999994083028766, 0.9999972210258663, 0.9999995653102954, 0.9999960466272413],
        'vec32': [0.9999998284000751, 0.9999996543470606]
    },
    'num3': {
        'vec1': [0.9974755105672704, 0.9966637349948626, 0.9971889394340727, 0.9982500757502197, 0.9976328281798962],
        'vec2': [0.9970957130127999, 0.9965065346807187, 0.995643680857009, 0.9967167325337339, 0.9960554186743931],
        'vec3': [0.9971736107726941, 0.9958391503959094, 0.9973867929045753, 0.9971260115043162, 0.9971652815669964],
        'vec4': [0.9998702310274097, 0.9964225989549477, 0.9986464096502651, 0.9999125439004655, 0.9997923404270032],
        'vec5': [0.9995825502449261, 0.9997659390064791, 0.9997626967983145, 0.9997975214290065, 0.9999808063689689],
        'vec6': [0.9996819096226506, 0.9999634248708982, 0.9998886858947087, 0.9989754016542134, 0.9999998668125099],
        'vec7': [0.9999738431716739, 0.9999787887526936, 0.9999790247980888, 0.9999395872423821, 0.9999734916188809],
        'vec8': [0.9999768102717376, 0.9999904331085363, 0.9999793997628397, 0.9999941398837899, 0.9999930434685396],
        'vec9': [0.9999997708783332, 0.9999975952998152, 0.999993843800253, 0.9999852382321324, 0.9999989527827815],
        'vec10': [0.9999980782043572, 0.9999903047235981, 0.9999901689935671, 0.9999903778838208, 0.9999888031994266],
        'vec11': [0.999996007292064, 0.9999978760974068, 0.9999960618523647, 0.9999980330106462, 0.9999936846519226],
        'vec12': [0.9999985025912292, 0.9999992241133268, 0.99999866566687, 0.9999947489844541, 0.9999961733037863],
        'vec13': [0.9999952578725743, 0.9999961409291014, 0.9999979843527877, 0.9999980689996911, 0.9999980670618753],
        'vec14': [0.9999964896541259, 0.9999986776487967, 0.9999996182894229, 0.9999960199537041, 0.9999973940202914],
        'vec15': [0.9999992791185622, 0.9999977205952353, 0.9999982439387786, 0.999998967643886, 0.9999975893879112],
        'vec16': [0.9999986969454213, 0.9999979507593598, 0.9999981724963007, 0.9999994155419456, 0.999999999992031],
        'vec17': [0.9999981895339383, 0.999998697456745, 0.9999976629149708, 0.9999986853505067, 0.9999982656152048],
        'vec18': [0.9999970111996996, 0.9999985430856646, 0.9999991656193216, 0.9999975574039273, 0.9999985002759517],
        'vec19': [0.9999986093708797, 0.9999979444159155, 0.9999985464899661, 0.9999989041578117, 0.9999989487419209],
        'vec20': [0.9999991154496704, 0.9999997642143093, 0.999999047356624, 0.9999996482069182, 0.9999985205628157],
        'vec21': [0.9999996867321317, 0.9999992519709756, 0.9999992040966472, 0.9999991508293012, 0.9999994837667083],
        'vec22': [0.9999982695156331, 0.9999994511184709, 0.9999993992413179, 0.9999995676231818, 0.9999996413000035],
        'vec23': [0.49999978226172626, 0.9999994818702358, 0.9999974244159768, 0.999999101861221, 0.9999995788131981],
        'vec24': [0.9999990373668102, 0.9999981917112553, 0.9999998502510022, 0.999999531236677, 0.9999996693040054],
        'vec25': [0.9999989030404624, 0.9999984087433138, 0.9999992348924084, 0.9999969494648642, 0.9999960548012128],
        'vec26': [0.9999995259812446, 0.9999940837245769, 0.9999984778374822, 0.9999995379446518, 0.9999995767481428],
        'vec27': [0.9999996138116362, 0.9999988101555504, 0.9999990595840078, 0.999999416215896, 0.9999999441745686],
        'vec28': [0.9999996643033069, 0.9999973876144302, 0.9999993636250994, 0.9999981354488541, 0.9999966563291283],
        'vec29': [0.9999995823163854, 0.9999995223951514, 0.9999998267253714, 0.9999983080793602, 0.9999992236635611],
        'vec30': [0.9999998396091871, 0.999999356814346, 0.999999748253113, 0.9999996423708924, 0.9999994324605488],
        'vec31': [0.999999672645886, 0.9999992748723019, 0.9999999010330961, 0.9999998655769144, 0.9999993329375811],
        'vec32': [0.9999997471465962, 0.9999995804360952, 0.9999996247316321, 0.9999993466733381, 0.9999979331418591],
        'vec33': [0.9999997209535741, 0.9999983326349541, 0.9999990460385411, 0.9999982030364327, 0.9999982961229412],
        'vec34': [0.9999998396171978, 0.9999995309793988, 0.9999995046440115, 0.9999996990024165, 0.999999394436132],
        'vec35': [0.9999999388987014, 0.9999996831219606, 0.9999995949497146, 0.9999990918714705, 0.9999996733911867],
        'vec36': [0.999999533395852, 0.9999999074376493, 0.9999996987691729, 0.999999915138619, 0.9999996132591782],
        'vec37': [0.9999979216466572, 0.7474276245307113, 0.9999996848423296, 0.9999978677274273, 0.9999994079332867],
        'vec38': [0.9999996717554818, 0.9999994384288662, 0.999999043218833, 0.9999990747227467]
    },
    'num4': {
        'vec1': [0.9969906434194008, 0.9944427301060443, 0.9952445886766289, 0.9940521807812964, 0.9975055317918352],
        'vec2': [0.9908453693185165, 0.9860228777996947, 0.9919019430907227, 0.9866733718144363, 0.9906291827094346],
        'vec3': [0.9974233374124295, 0.9981472067970589, 0.998369007133225, 0.9977924922034285, 0.9985600154296536],
        'vec4': [0.9986145727437792, 0.9984396976299552, 0.9993225770122252, 0.9861556427299858, 0.9882999246485124],
        'vec5': [0.9982467098816279, 0.9984244952964746, 0.9991918003692238, 0.9986735379475179, 0.9995421914642159],
        'vec6': [0.9999235080022921, 0.999991161920416, 0.9999983776471515, 0.9999772187683855, 0.9996612335044671],
        'vec7': [0.9999747478904961, 0.9999953020161556, 0.999933135166696, 0.9999100287734162, 0.9999191062516538],
        'vec8': [0.9999614652695029, 0.9999393348287137, 0.9999401955528003, 0.9999503596070345, 0.9999827614245353],
        'vec9': [0.9999761481337512, 0.9999633565904763, 0.9999802241454776, 0.9999676207477208, 0.9999794517487433],
        'vec10': [0.9999806789550127, 0.9999822638215315, 0.9999814491055957, 0.9999942986243822, 0.9999777373347738],
        'vec11': [0.9999877293596758, 0.9999866639424647, 0.9999837682916344, 0.9999861682158604, 0.9295439656712956],
        'vec12': [0.99998899846167, 0.9999914348542421, 0.9999927238640606, 0.9999898923906267, 0.999991108963546],
        'vec13': [0.9999932545165118, 0.9999975971878392, 0.9999988166523205, 0.9999916195793086, 0.9999894939591423],
        'vec14': [0.9999973406978493, 0.9999941706473514, 0.9999952400511695, 0.9999959672209646, 0.9999999633053372],
        'vec15': [0.9999974170121871, 0.9999991637063598, 0.9999951640313758, 0.9999950332315347, 0.9999980416455754],
        'vec16': [0.9999962107395625, 0.9999998662191273, 0.9999966729496597, 0.9999971791537665, 0.9999972502879438],
        'vec17': [0.9999974622579547, 0.9999963826661593, 0.9999974654858349, 0.9999975818105109, 0.9999964755072932],
        'vec18': [0.999996046809382, 0.999999138451641, 0.9999955699015207, 0.9999985994695535, 0.9999994709111999],
        'vec19': [0.9999975505333765, 0.9999977680164236, 0.9999988285176727, 0.9999951156387537, 0.9999983302690639],
        'vec20': [0.9999985595301925, 0.9999976822803993, 0.9999984274202111, 0.9999998636450695, 0.9990288078858742],
        'vec21': [0.9999989845583075, 0.9999953905805294, 0.9999986982777601, 0.9999959532092765, 0.9999977643450826],
        'vec22': [0.9999991664454744, 0.9999988887268412, 0.9999986039217631, 0.9999988080390512, 0.9999954315162325],
        'vec23': [0.999998689258785, 0.9999985402697007, 0.9999998111223584, 0.9999990278678477, 0.9999996601602739],
        'vec24': [0.9999998331603135, 0.9999999485222741, 0.4999996461047139, 0.9999996128219352, 0.9999992052870866],
        'vec25': [0.9999991506842215, 0.9999990023957821, 0.9999991787551605, 0.9999992455973223, 0.9999990711819841],
        'vec26': [0.9999991016548199, 0.9999992384750578, 0.9999998487204287, 0.9999991878461453, 0.9999988016644872],
        'vec27': [0.9999996104862742, 0.9999987260492369, 0.9999994153036365, 0.9999993922540057, 0.999998958338828],
        'vec28': [0.9999993358027792, 0.9999994513487425, 0.9999991078216339, 0.9999998318887322, 0.9999986041173352],
        'vec29': [0.9999999999991195, 0.9999993986774429, 0.9999994173048172, 0.9999992878972392, 0.9999993632127822],
        'vec30': [0.9999992012217155, 0.9999990971978245, 0.9999994861182073, 0.9999994399445448, 0.9999993434866687],
        'vec31': [0.999999282033144, 0.9999984389379768, 0.9999995905531507, 0.9999997515793281, 0.9999991981461678],
        'vec32': [0.9999994972019529, 0.9999958275819745, 0.9999986911996587, 0.9999994843962837, 0.9999457072544349],
        'vec33': [0.9999995744182826, 0.9999998163201933, 0.9999989728254829, 0.9999992116354962, 0.9999999937588997],
        'vec34': [0.9999993615461571, 0.9999947049139181, 0.9999995074375244, 0.9999998537499971, 0.9999922380805493],
        'vec35': [0.999999322318716, 0.999999398334094, 0.9999987824001159]
    },
    'num5': {
        'vec1': [0.9984858956327886, 0.9963606335573533, 0.9957571903115661, 0.9939211822289411, 0.9947933039281487],
        'vec2': [0.9995207159554849, 0.9986025320019913, 0.9993800201751111, 0.9990310926686017, 0.9979847676306459],
        'vec3': [0.9997213031223166, 0.9992054294638983, 0.9994416924931048, 0.999503285200919, 0.9998428071249669],
        'vec4': [0.9999441395397394, 0.9999151783133338, 0.9999313274121417, 0.9999054075217451, 0.9996042335537438],
        'vec5': [0.9999595126066759, 0.9999763852450492, 0.9999547247218745, 0.9999222468636582, 0.9999805809972252],
        'vec6': [0.9999912772054266, 0.9999937235237965, 0.9999894262245297, 0.9999887705451018, 0.999989744047059],
        'vec7': [0.9999944809306914, 0.9999939595946737, 0.9999923278365538, 0.9999922062116731, 0.9999872473793061],
        'vec8': [0.9999582821380923, 0.9999953763941388, 0.999996904174527, 0.9999933266663883, 0.9999957781184174],
        'vec9': [0.9999977734620207, 0.999998447983135, 0.9999984549986044, 0.9999976287295012, 0.9999967579509742],
        'vec10': [0.9999970376193383, 0.9999984066855517, 0.9999970238381426, 0.9999974552555713, 0.9999977975980815],
        'vec11': [0.9999988042424335, 0.9999990251414559, 0.9999992106383077, 0.9999986999190527, 0.9999990200460201],
        'vec12': [0.9999993706942516, 0.9999990485938733, 0.9999978967031451, 0.9999984110032297, 0.9999990222392473],
        'vec13': [0.9999991874955343, 0.9999994804280249, 0.9999993866107105, 0.9999995325344029, 0.9999990595723185],
        'vec14': [0.9999997244960191, 0.9999997133379491, 0.9999997178125548, 0.9999989811837214, 0.9999981230115924],
        'vec15': [0.999999455024417, 0.9999994564493073, 0.9999998466871616, 0.9999995741249941, 0.9999996295268878],
        'vec16': [0.9999954470184764, 0.9999990554557869, 0.9999989697597107, 0.9999987738901621, 0.999997399002057],
        'vec17': [0.9999998438262974, 0.9999996712723518, 0.9999996927750432, 0.9999997208175962, 0.9999998145689896],
        'vec18': [0.9999998749585881, 0.9999993087795205, 0.9999997353845581, 0.9999994612975995, 0.9999996193420932],
        'vec19': [0.9999996042948962, 0.9999941251718029, 0.9999998437241118, 0.9999991471021036, 0.9999996439376415],
        'vec20': [0.9999977287308974, 0.9999984665718793, 0.9999998753303132, 0.9999985511600026, 0.999997522139226],
        'vec21': [0.9999999501277963, 0.9999997618526676, 0.9999990658705907, 0.9999997728284119, 0.9999997735763901],
        'vec22': [0.999999372400663, 0.9999987011349272, 0.999999658299989, 0.9999996047192993, 0.9999998823542029],
        'vec23': [0.9999992933242401, 0.9999998327956442, 0.9999999668595881, 0.9999999448713722, 0.9999989680981898],
        'vec24': [0.999999528985722, 0.9999998243076871, 0.4999999653022239, 0.9999993294505671, 0.9999999419363073],
        'vec25': [0.9999997662991383, 0.9999997984318892, 0.9999997840530701, 0.9999998802503834, 0.9999999373482931],
        'vec26': [0.9999980514036912, 0.9999998243418212, 0.999999965996358, 0.9999999516539589, 0.9999995488403293],
        'vec27': [0.9999999823727177, 0.9999835330209758, 0.9999997294972892, 0.9999999431216735, 0.9999983780358059],
        'vec28': [0.9999994211250849, 0.999999701671922, 0.9999998369577181, 0.9999988333483033, 0.999999969907523],
        'vec29': [0.999999661331716, 0.9999995250877769, 0.9999973862462768, 0.99999997357639, 0.99999952017095],
        'vec30': [0.9999971307468272, 0.9999995769408184, 0.9999998958144904, 0.49999941844863705, 0.9999994936981644],
        'vec31': [0.9999999703744813, 0.999997757480171, 0.9999991258111116, 0.9999994925727118, 0.9999944939348983],
        'vec32': [0.9999995917392608, 0.999999100455323]
    }
}
fidelity_20240305 = {
    'num1': {},
    'num2': {},
    'num3': {},
    'num4': {},
    'num5': {}
}

for i in fidelity.keys():
    for k, v in fidelity_20240202[i].items():
        fidelity[i][k].extend(v)
    for k, v in fidelity_20240305[i].items():
        fidelity[i][k].extend(v)
    fidelity[i] = dict(fidelity[i])

for i in fidelity.keys():
    for k, v in fidelity[i].items():
        print(i, k, len(v))
    print()

for num in range(1, 6):
    sub = sorted(os.listdir('./data_322'))[num + 1]
    path = f'./data_322/{sub}'  # path of subfolder
    # print(num, fidelity[f'num{num}'])
    # savemat(f'{path}/fidelity_num{num}_D5_L2.mat', fidelity[f'num{num}'])