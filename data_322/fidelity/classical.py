import numpy as np
from scipy.io import savemat

fidelity = {'num1': [], 'num2': [], 'num3': [], 'num4': [], 'num5': []}
fidelity_20240407 = {
    'num1': [
        0.9999977268255268, 0.9999984568613266, 0.9999974196797675, 0.9999944221446555, 0.9999990506172066,
        0.9999961054430933, 0.9999981244416788, 0.9999985894555925, 0.9999977075043773, 0.9999985452914167
    ],
    'num2': [
        0.9999999669401257, 0.9999999999992466, 0.9999997258541633, 0.9999999789689666, 0.9999994847568188,
        0.9999998363872882, 0.9999998738133721, 0.9999999917152615, 0.9999999999991024, 0.9999999227205993
    ],
    'num3': [
        0.9999997970894323, 0.9999999999993947, 0.9999999973089518, 0.9999999580957133, 0.9999994040251425,
        0.9999998264284301, 0.9999999990529613, 0.9999997286074702, 0.9999993303970841, 0.9999991526794989
    ],
    'num4': [
        0.9999984859389422, 0.9999998377769223, 0.9999983184399406, 0.9999987900782651, 0.999999631368978,
        0.9999976946909922, 0.999999732843997, 0.9999998360755953, 0.9999982025042822, 0.9999988136386502
    ],
    'num5': [
        0.9999997989467875, 0.999999490495072, 0.999999894753945, 0.9999999999990401, 0.999999541355041,
        0.9999996700939963, 0.9999999999990004, 0.9999994677059955, 0.9999999996390782, 0.9999994387045521
    ]
}
fidelity_20240409 = {
    'num1': [
        0.9999967581459188, 0.9999987393893933, 0.9999957966515884, 0.9999989517857171, 0.9999914359901753,
        0.9999990358990106, 0.9999974761068825, 0.9999982004489117, 0.9999973159254263, 0.9999954334696045
    ],
    'num2': [
        0.9999999236367298, 0.9999999217757658, 0.999999865254312, 0.9999994252400224, 0.9999997010651384,
        0.9999987487011393, 0.9999999938878328, 0.9999999810510041, 1.000000000000715, 0.9999999776177251
    ],
    'num3': [
        0.9999999689390203, 0.9999995606024721, 0.9999999980997338, 0.9999997814838556, 0.9999996806689052,
        0.9999990220132999, 0.9999995265372816, 0.9999999500527802, 0.9999993765536977, 1.0000000000003515
    ],
    'num4': [
        0.9999991384229241, 0.9999981327398348, 0.9999999641310342, 0.9999985783277258, 0.999999259020925,
        0.9999993863055255, 0.9999999087045088, 0.9999996958176985, 0.9999918825607115, 0.9999970561713574
    ],
    'num5': [
        0.9999999575725849, 0.9999996088563674, 0.9999999999987594, 0.9999999668803019, 0.9999999686626274,
        0.9999999956877114, 0.9999999999994786, 0.9999992371282791, 0.9999999999771141, 0.9999967497810409
    ]
}
fidelity_20240412 = {
    'num1': [
        0.9999931160991029, 0.9999920613660113, 0.9999970112537252, 0.999996653351942, 0.9999949915550833,
        0.9999894505464472, 0.9999962871309735, 0.9999975984823121, 0.9999964618613644, 0.9999974715871297,
        0.9999931160991029, 0.9999920613660113, 0.9999970112537252, 0.999996653351942, 0.9999949915550833,
        0.9999894505464472, 0.9999962871309735, 0.9999975984823121, 0.9999964618613644, 0.9999974715871297,
        0.9999926953563061, 0.9999948031453787, 0.9999937152464587, 0.9999977324315723, 0.9999995366614561,
        0.9999970257528048, 0.9999967177114343, 0.9999990240296115, 0.9999981228424386, 0.9999887355871264,
        0.9999951599612606, 0.9999961744167433, 0.9999995136054751, 0.9999947414960209, 0.9999979729819437,
        0.9999968230645022, 0.9999946651531301, 0.9999949081669147, 0.9999960364266046, 0.9999886390643666,
        0.9999936397922106, 0.9999956335843078, 0.999987550494326, 0.9999915785051192, 0.9999943243793195,
        0.999989439371899, 0.9999969873131139, 0.9999946535166084, 0.9999839087906365, 0.9999924863749852
    ]
}

for i in fidelity.keys():
    fidelity[i].extend(fidelity_20240407[i])
    fidelity[i].extend(fidelity_20240409[i])
fidelity['num1'].extend(fidelity_20240412['num1'])

for k, v in fidelity_20240412.items():
    v_mean = np.mean(sorted([i for i in v if i < 1], reverse=True)[:10])
    print(k, len(v), f'{v_mean:.15f} {1-v_mean:.8e} {1-np.mean(v):.8e} {np.mean(v):.15f}')

for k, v in fidelity.items():
    v_mean = np.mean(sorted([i for i in v if i < 1], reverse=True)[:10])
    print(k, len(v), f'{v_mean:.15f} {1-v_mean:.8e} {1-np.mean(v):.8e} {np.mean(v):.15f}')

path = f'./data_322/classical'
# savemat(f'{path}/fidelity_classical_L2.mat', fidelity)