import numpy as np
from scipy.io import savemat

fidelity = {'num1': [], 'num2': [], 'num3': [], 'num4': [], 'num5': []}
fidelity_20240407 = {
    'num1': [
        0.9999977268255268, 0.9999984568613266, 0.9999974196797675, 0.9999944221446555, 0.9999990506172066,
        0.9999961054430933, 0.9999981244416788, 0.9999985894555925, 0.9999977075043773, 0.9999985452914167
    ],
    'num2': [
        0.9999999669401257, 0.9999999999992466, 0.9999997258541633, 0.9999999789689666, 0.9999994847568188,
        0.9999998363872882, 0.9999998738133721, 0.9999999917152615, 0.9999999999991024, 0.9999999227205993
    ],
    'num3': [
        0.9999997970894323, 0.9999999999993947, 0.9999999973089518, 0.9999999580957133, 0.9999994040251425,
        0.9999998264284301, 0.9999999990529613, 0.9999997286074702, 0.9999993303970841, 0.9999991526794989
    ],
    'num4': [
        0.9999984859389422, 0.9999998377769223, 0.9999983184399406, 0.9999987900782651, 0.999999631368978,
        0.9999976946909922, 0.999999732843997, 0.9999998360755953, 0.9999982025042822, 0.9999988136386502
    ],
    'num5': [
        0.9999997989467875, 0.999999490495072, 0.999999894753945, 0.9999999999990401, 0.999999541355041,
        0.9999996700939963, 0.9999999999990004, 0.9999994677059955, 0.9999999996390782, 0.9999994387045521
    ]
}
fidelity_20240409 = {
    'num1': [0.9999941728185772, 0.9999966173809476, 0.9999953286166811, 0.9999970106582563, 0.9999971385481912],
    'num2': [0.9999997205175762, 0.9999998723452032, 0.999999778295557, 0.9999999886354861, 0.9999998068266639],
    'num3': [0.9999996687408981, 0.9999994177260058, 0.9999999658059269, 0.9999995081419466, 0.9999996366075289],
    'num4': [0.9999960326557304, 0.9999970671532842, 0.9999976512822467, 0.9999996453060763, 0.9999968666353279],
    'num5': [0.9999999999989133, 0.9999999622446397, 0.9999999999988207, 0.9999999999991903, 0.999999999999077]
}

for i in fidelity.keys():
    fidelity[i].extend(fidelity_20240407[i])
    fidelity[i].extend(fidelity_20240409[i])

for k, v in fidelity.items():
    v_mean = np.mean(sorted(v, reverse=True)[:10])
    print(k, len(v), v_mean, np.mean(v))

path = f'./data_322/classical'
savemat(f'{path}/fidelity_L2.mat', fidelity)